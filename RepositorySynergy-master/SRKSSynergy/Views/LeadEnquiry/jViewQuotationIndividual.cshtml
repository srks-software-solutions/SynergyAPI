@model IEnumerable<SRKSSynergy.Models.QGEquipGeneralData>
@{
    ViewBag.Title = "jViewQuotationIndividual";
    Layout = null;
    int slno = 1;
}

<link href="~/Content/bootstrap/css/bootstrap.css" rel="stylesheet" />
<link href="~/Content/bootstrap/css/bootstrap-responsive.css" rel="stylesheet" />
<link href="~/Content/bootstrap/css/MDB.css" rel="stylesheet" />
<link href="~/Content/bootstrap/css/jquery.ui.autocomplete.css" rel="stylesheet" />
<link href="~/Content/bootstrap/css/print.css" media="print" rel="stylesheet" />
<script src="~/Content/bootstrap/js/jquery.js"></script>
<script src="~/Content/bootstrap/js/jquery-ui.js"></script>
<script src="~/Content/bootstrap/js/jquery1.8.2.min.js"></script>
<script src="~/Content/bootstrap/js/jQuery%20UI%201.9.2.js"></script>

<div class="bcgr" style="height: 14000px; width: 1100px; padding-top: 5%">
    <div class="navbar-fixed-top" style="background: gray; padding-bottom: 15px">
        <p class="txtft1">Quotation Generated</p>
        <div class="navbar navbar-fixed-top" style="margin: -1px -1px 0;">
            <ul class="nav pull-right " style="padding-right: 50px">
                <li style="padding-top: 10px; font: 20px; color: white;">
                    <a href="/Account/Login" class="btn" style="width: 50px; height: 15px; background: #009B91; text-decoration: none; font-size: 14px; color: white;"><strong>Logout</strong></a>
                </li>
            </ul>
        </div>
    </div>

    <div style="background: #BBBEBD; padding-bottom: 5px; height: 40px">
        <p class="txtft" style="font-size: 22px">
             @{
                var fromdate = @Session["Fromdate"];
                var todate = @Session["Todate"];
            }
            @*<a href="/LeadEnquiry/DisplayQuotationWithParticularDates" class="btn" style="height: 15px; background: #009B91; text-decoration: none; font-size: 14px; color: white; float: left"><strong>Back ToList</strong></a>*@
           @Html.ActionLink("Back To List", "DisplayQuotationWithParticularDates", "LeadEnquiry", new { fromdat = fromdate, todat = todate }, new {@class="btn", @style = "float:left;padding-left:5%;font-size:16px;font-weight:bold" })
             Period    &nbsp; &nbsp;  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  &nbsp; &nbsp; &nbsp;
                      From:- @Session["Fromdate"]&nbsp;&nbsp; &nbsp; &nbsp;To:- @Session["Todate"]
        </p>
    </div>

    <form action="@Url.Action("ViewQuotationIndividually", "LeadEnquiry")" method="post">

        @*Success Message*@
        @if (TempData["Success"] != null)
        {
            <p style="color: red; font-weight: 900; padding-left: 170px">@TempData["Success"]</p>
        }

@* Table for Equipment *@
        <table class="table table-hover" style="width: 1400px;">
            <tr style="background: #BBBEBD; padding-bottom: 10px; padding-top: 10px">
                <th style="width: 40px; text-align: center">
                    <span style="font-family: Calibri; font-size: 18px; padding-bottom: 10px; padding-top: 10px">Serial No.</span>
                </th>
                <th style="width: 160px; text-align: center">
                    <span style="font-family: Calibri; font-size: 18px; padding-bottom: 10px; padding-top: 10px">Channal Partner</span>
                </th>
                <th style="width: 160px; text-align: center">
                    <span style="font-family: Calibri; font-size: 18px; padding-bottom: 10px; padding-top: 10px">Customer Name</span>
                </th>
                <th style="width: 160px; text-align: center">
                    <span style="font-family: Calibri; font-size: 18px; padding-bottom: 10px; padding-top: 10px">Quotation Number</span>
                </th>
                <th style="width: 160px; text-align: center">
                    <span style="font-family: Calibri; font-size: 18px; padding-bottom: 10px; padding-top: 10px">Equipment Name</span>
                </th>
                <th style="width: 120px; text-align: center;">
                    <span style="font-family: Calibri; font-size: 18px; padding-bottom: 10px; padding-top: 10px">Quotation Date</span>
                </th>
                <th style="width: 250px;" class="noPrint"></th>
            </tr>
            @{

                SRKSSynergy.Models.SRKS_Synergy db = new SRKSSynergy.Models.SRKS_Synergy();

                //DateTime dtt = ViewBag.Fromdate;
                //DateTime dtt1 = ViewBag.Todate;

                //String frda1 = dtt.ToString();
                //String toda1 = dtt1.ToString();

                //DateTime frda = DateTime.Parse(frda1).Date;
                //DateTime toda = DateTime.Parse(toda1).Date;

                //var jfdate = frda;
                //var jtdate = toda; 
                
                DateTime dtt = ViewBag.Fromdate;
                DateTime dtt1 = ViewBag.Todate;

                String frda1 = dtt.ToString("yyyy-MM-dd");
                String toda1 = dtt1.ToString("yyyy-MM-dd");

                DateTime frda = DateTime.Parse(frda1).Date;
                DateTime toda = DateTime.Parse(toda1).Date;

                var jfdate = frda;
                var jtdate = toda; 
                
            }
            @foreach (var item in Model)
            {
                //DateTime fromdate1 = Convert.ToDateTime(@Session["Fromdate"]);
                //DateTime todate1 = Convert.ToDateTime(@Session["Todate"]);
                <tr>
                    <td style="width: 40px; text-align: center; font-family: Calibri; font-size: 18px">
                        @slno
                    </td>
                    <td style="width: 120px; text-align: center; font-family: Calibri; font-size: 18px">
                        @if (item.CPID != 0)
                        {
                            {
                                var name = db.ChannelPartners.Where(m => m.CPID == item.CPID).Select(m => m.CPName).SingleOrDefault();
                                ViewBag.drp1 = name;
                            }                        
                            @ViewBag.drp1
                        }
                        else
                        {
                            <label style="font-family: Calibri; font-size: 18px;">Buhler India Pvt Ltd</label>
                        }
                    </td>
                    <td style="width: 120px; text-align: center; font-family: Calibri; font-size: 18px">
                        @{
                        var name1 = db.MDBGeneralData.Where(m => m.MDBID == item.MDBID).Select(m => m.OrganizationName).SingleOrDefault();
                        ViewBag.drp1 = name1;                
                        }
                        @ViewBag.drp1
                    </td>
                    <td style="width: 90px; text-align: center; font-family: Calibri; font-size: 18px">
                        @Html.DisplayFor(modelItem => item.QuotationNumber)
                    </td>
                    <td style="width: 90px; text-align: center; font-family: Calibri; font-size: 18px">
                        @{
                        int id = ViewBag.id;

                        var qgid = item.QGID;
                        string prodnm = null;

                        if (qgid != null)
                        {
                            var prodmodelid = db.QGEquipTableData.Where(m => m.QGID == qgid).Select(m => m.ProductModelID).FirstOrDefault();


                            prodnm = db.ProductModel.Where(m => m.ProductModelID == prodmodelid).Select(m => m.ProductModelName).SingleOrDefault();
                            if (prodnm != null)
                            {
                                ViewBag.prodname = prodnm;
                            }
                            else
                            {
                                ViewBag.prodname = "No Model";
                            }
                        }                                            
                        }
                        @ViewBag.prodname
                    </td>

                    <td style="width: 120px; text-align: center; font-family: Calibri; font-size: 18px">
                        @{
                        //var created = db.QGEquipGeneralData.Where(m => m.IsRiceMill == 0).Where(m => m.QGID == item.QGID).Where(m => m.QuotationDate > startDate && m.QuotationDate < enddate1).Select(m => m.QuotationDate).SingleOrDefault();
                        
                        var created = (from r in db.QGEquipGeneralData
                                           where r.IsRiceMill == 0 && r.QGID == item.QGID && r.QuotationDate >= jfdate && r.QuotationDate <= jtdate
                                    select r.QuotationDate).SingleOrDefault();

                        DateTime td = Convert.ToDateTime(created);
                        string dd = td.ToString("dd-MM-yyyy");
                        ViewBag.drp = dd;                
                        }
                        @ViewBag.drp
                    </td>

                </tr>                 
                        slno++;
            }
        </table>
    </form>
</div>

