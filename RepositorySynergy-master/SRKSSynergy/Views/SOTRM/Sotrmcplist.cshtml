@model IList<SRKSSynergy.Models.SOTRM>
@using SRKSSynergy.Helpers
@{

    ViewBag.Title = "SOTRM CP List";
}

@{int slno = 1;}

<link href="~/Content/bootstrap/css/bootstrap-responsive.css" rel="stylesheet" />
<link href="~/Content/bootstrap/css/bootstrap.css" rel="stylesheet" />
<link href="~/Content/bootstrap/css/MDB.css" rel="stylesheet" />
<link href="~/Content/bootstrap/css/jquery-min.css" rel="stylesheet" />
<script src="~/Content/bootstrap/js/jquery.js"></script>
<script src="~/Content/bootstrap/js/jquery-ui-min.js"></script>
<script src="~/Content/bootstrap/js/bootstrap.js"></script>
<script src="~/Content/bootstrap/js/accounting.js"></script>
<script src="~/Content/bootstrap/js/jquery.mtz.monthpicker.js"></script>

<script>
    $(document).ready(function () {
    $('.sss').monthpicker();
  });
</script>

@if (TempData["msg"] != null)
{
    <script>alert('No Data Available for this Quotation...!')</script>
}

<div class="bcgr" style="min-width: 1450px">
    @using (Html.BeginForm("Sotrmcplist", "SOTRM", Model, FormMethod.Post))
    {
        @Html.AntiForgeryToken()
        @Html.ValidationSummary(true)
        <div style="background: gray; padding-bottom: 15px">
            <p class="txtft">Sales Opportunity Tracker</p>
        </div>
        <div class="row" style="padding-top: 10px">
            <div class=" row show-grid">
                <div style="padding-top: 30px; padding-left: 40px">
                    <table class="table-hover">
                        <thead>
                            <tr style="background: #BBBEBD">
                                <th style="width: 50px; text-align: center" class="fntst cal botbor">Serial No</th>
                                <th style="width: 220px; text-align: center" class="fntst cal botbor">Company Name</th>
                                <th style="width: 130px; text-align: center" class="fntst cal botbor">Sales Engg Name</th>
                                <th style="width: 110px; text-align: center" class="fntst cal botbor">Quotation No</th>
                                <th style="width: 80px; text-align: center" class="fntst cal botbor">Section</th>
                                <th style="width: 80px; text-align: center" class="fntst cal botbor">Machine</th>
                                <th style="width: 100px; text-align: center" class="fntst cal botbor">Model</th>
                                <th style="width: 40px; text-align: center" class="fntst cal botbor">Quantity</th>
                                <th style="width: 150px; text-align: center" class="fntst cal botbor">Order Activeness</th>
                                <th style="width: 70px; text-align: center" class="fntst cal botbor">BYJT Chances(%)</th>
                                <th style="width: 150px; text-align: center" class="fntst cal botbor">Top Competitor</th>
                                <th style="width: 80px; text-align: center" class="fntst cal botbor">Expected Order Month</th>
                                <th style="width: 70px; text-align: center" class="fntst cal botbor">Additional Comments</th>
                            </tr>
                        </thead>
                        @*@foreach (var item in Model)*@
                        @for (int i = 0; i < Model.Count; i++)
                        {
                            <tr>
                                <td style="width: 50px; text-align: center;">
                                    @slno
                                </td>
                                <td style="width: 150px; text-align: center;">
                                    <label class="fntst">@Html.DisplayFor(m => m[i].QGEquipGeneralData.MDBGeneralData.OrganizationName)</label>
                                </td>
                                <td style="width: 110px; text-align: center;">
                                    <label class="fntst">@Html.DisplayFor(m => m[i].QGEquipGeneralData.SalesName)</label>
                                </td>
                                <td style="width: 110px; text-align: center;">
                                    <label class="fntst">@Html.DisplayFor(m => m[i].QGEquipGeneralData.QuotationNumber)</label>
                                </td>
                                <td style="width: 80px; text-align: center;">
                                    <label class="fntst">@Html.DisplayFor(m => m[i].MasterProducts.MasterProductName)</label>
                                </td>
                                <td style="width: 80px; text-align: center;">
                                    <label class="fntst">@Html.DisplayFor(m => m[i].Products.ProductName)</label>
                                </td>
                                <td style="width: 100px; text-align: center;">
                                    <label class="fntst">@Html.DisplayFor(m => m[i].Equipment)</label>
                                </td>
                                <td style="width: 40px; text-align: center;">
                                    <label class="fntst">@Html.DisplayFor(m => m[i].Quantity)</label>
                                </td>
                                <td style="width: 150px; text-align: center;">
                                    @Html.MyDropdownListFor(m => m[i].Orderactive, (IList<MyHelpers.MySelectItem>)ViewData["active" + slno], null, new { id = "active" + slno, @class = "fntst dropped", @style = "width:130px", @name = "active" + slno })
                                </td>
                                <td style="width: 60px; text-align: center;">
                                    @Html.MyDropdownListFor(m => m[i].BYJTChances, (IList<MyHelpers.MySelectItem>)ViewData["chances" + slno], null, new { id = "chances" + slno, @class = "fntst chances", @name = "chances" + slno, @style = "width:65px" })
                                </td>
                                <td style="width: 150px; text-align: center;">
                                    @Html.MyDropdownListFor(m => m[i].TOPCompetitors, (IList<MyHelpers.MySelectItem>)ViewData["comp" + slno], null, new { id = "comp" + slno, @class = "fntst competitor", @style = "width:150px", @name = "comp" + slno })
                                </td>
                                <td style="width: 80px; text-align: center;">
                                    @*@Html.MyDropdownListFor(m => m[i].Expectedorder, (IList<MyHelpers.MySelectItem>)ViewData["mon" + slno], null, new { id = "mon" + slno, @class = "input-mini4 fntst ", @required = "required", @style = "width:130px", @name = "mon" + slno })*@
                                    @Html.TextBoxFor(m => m[i].Expectedorder, new { @id = "startdate" + slno, @name = "startdate" + slno, @placeholder = "Select Month", @class = "input-mini4 fntst sss eom", @style = "width:130px", @required = "required" })
                                </td>
                                <td style="text-align: center; width: 70px">
                                    @Html.TextAreaFor(m => m[i].AdditionalComments, new { rows = 2, columns = 2, id = "addcomc" + slno, @minlength = 4, @class = "fntst", @placeholder = "Minimum 4 Characters" })
                                </td>
                                <td style="text-align: center;">
                                    @*@Html.TextBoxFor(m => m[i].Commodity, new { @style = "display:none;" })*@
                                    @Html.HiddenFor(m => m[i].QGID)
                                    @Html.HiddenFor(m => m[i].SOTRMID)
                                    @Html.HiddenFor(m => m[i].CPID)
                                    @Html.HiddenFor(m => m[i].Equipment)
                                    @Html.HiddenFor(m => m[i].Quantity)
                                    @Html.HiddenFor(m => m[i].MasterProductID)
                                    @Html.HiddenFor(m => m[i].ProductID)
                                </td>
                            </tr>
                            slno++;
                        }
                    </table>
                    <input type="text" id="getslno" value=@slno style="display:none;" />
                </div>
                <div class="row" style="padding-top: 20px; padding-left: 300px; padding-bottom: 20px">
                    <div class=" row show-grid">
                        <div class="span10">
                            <div class="span3 cent">
                                <input type="submit" value="Submit" class="btn btn-large btn-success" />
                                <div></div>
                                @*<button class="btn btn-large btn-success" type="button">Generate Report</button>*@
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    }
</div>


<script>
    //For restricting any field to its maxlength size
    $(document).ready(function () {
        $('input').keyup(function (e) {
            if (this.value.length == $(this).attr("minlength")) {
                e.preventDefault();
                $(event.target).next("span").html("Please Enter Minimum data").show().fadeOut(2000);
                return false;
            }
            return true;
        });
    });
</script>

<script>
    $(document).ready(function () {
        $(".dropped").change(function () {
            var name = $(this).val();
            //alert(name);
            if (name == "Project Dropped") {
                $(this).parents('td:first').siblings("td").children(".chances").attr('disabled', 'disabled');
                $(this).parents('td:first').siblings("td").children(".competitor").attr('disabled', 'disabled');
                $(this).parents('td:first').siblings("td").children(".eom").attr('disabled', 'disabled');
            }
            else {

                $(this).parents('td:first').siblings("td").children(".chances").removeAttr('disabled');
                $(this).parents('td:first').siblings("td").children(".competitor").removeAttr('disabled');
                $(this).parents('td:first').siblings("td").children(".eom").removeAttr('disabled');
            }
        });
    });
</script>