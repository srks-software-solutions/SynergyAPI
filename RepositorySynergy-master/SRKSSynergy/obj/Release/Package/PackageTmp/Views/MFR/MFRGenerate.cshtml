
@model IEnumerable<SRKSSynergy.Models.Handover>
@{
    ViewBag.Title = "Generate MFR";
    Layout = "~/Views/Shared/_Layout.cshtml";
    ViewBag.senapp = "Sent for Approval";
    ViewBag.pen = "Pending";
    ViewBag.app = "Approved";
    ViewBag.rej = "Rejected";
}


<link href="~/Content/bootstrap/css/jquery.ui.autocomplete.css" rel="stylesheet" />
<script src="~/Content/bootstrap/js/jquery-1.9.1.js"></script>
<script src="~/Content/bootstrap/js/jquery1.8.2.min.js"></script>
<script src="~/Content/bootstrap/js/jquery-ui-1.10.3.js"></script>
<script src="~/Content/bootstrap/js/bootstrap.js"></script>
@Scripts.Render("~/bundles/modernizr")

<script type="text/javascript">
    $(document).ready(function () {
        $("#cunam").autocomplete({
            source: function (request, response) {
                $.ajax({
                    url: "/HOD/Autocompleteexiscust",
                    type: "POST",
                    dataType: "json",
                    data: { term: request.term },
                    success: function (data) {
                        response($.map(data, function (item) {
                            return { label: item.OrganizationName, value: item.OrganizationName };
                        }))

                    }
                })
            },
            messages: {
                noResults: "", results: ""
            }
        });
    });
</script>

<input type="text" id="success" value="false" style="display: none;" />
<form action="@Url.Action("MFRGenerate", "MFR")" method="get">
    <div style="background: #e5e5e5; min-height: 100px">
        <div style="background: gray; padding-bottom: 15px">
            <p class="txtft">Generate MFR</p>
        </div>
        <div class="row" style="padding-top: 10px">
            <div class=" row show-grid">
                <div class="span12 pad ">
                    <div class="span3 ">
                        <div class="control-group ">
                            <label class="control-label fntst ">Customer Name</label>
                            <div class="controls ">
                                <input type="text" class="fntst excus" value="@ViewBag.Search" id="cunam" name="cunam" placeholder="Customer Name">
                            </div>
                        </div>
                    </div>
                    <div class="span3">
                        <div class="cent3">
                            <input type="submit" value="Get Details" id="gd" class="btn btn-info existingcustomer" />
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</form>
@* MFR Generated Message *@
		@if (TempData["MFRGen"] != null)
		{
			<p style="color: red; font-weight: 900; padding-left: 170px">@TempData["MFRGen"]</p>
		}
@if (ViewBag.IsSearch == true)
{
    <div id="getquotations">
        <table class="table table-striped" style="width: 1300px">
            @* header *@
            <tr align="center">
                <th align="center" style="width: 50px; text-align: center">SL.No</th>
                <th align="center" style="width: 100px; text-align: center">HOD Number</th>
                <th align="center" style="width: 100px; text-align: center">Order Number</th>
                <th align="center" style="width: 100px; text-align: center">Customer Name</th>
                <th align="center" style="width: 150px; text-align: center">Model Number</th>
                <th align="center" style="width: 100px; text-align: center">Machine Serial Number</th>
                <th align="center" style="width: 60px; text-align: center">Hand Over Date</th>
                <th align="center" style="width: 120px; text-align: center"></th>
            </tr>
            @{int i = 1;
              int slno = 1;}
            @foreach (var p in Model)
            {
                <tr>
                    <td align="center" style="width: 50px; text-align: center">@slno</td>
                    <td align="center" style="width: 100px; text-align: center">@p.HODNumber</td>
                    <td align="center" style="width: 100px; text-align: center">@p.OAnum</td>
                    <td align="center" style="width: 100px; text-align: center">@p.MDBGeneralData.OrganizationName</td>
                    <td align="center" style="width: 150px; text-align: center">@p.modelno</td>
                    <td align="center" style="width: 100px; text-align: center">@p.MacSlNo</td>
                    <td align="center" style="width: 60px; text-align: center">@Html.DisplayFor(modelitem => p.Handeddate)</td>
                    <td align="center" style="width: 120px; text-align: center">
                        @{
                            DateTime dbdate = Convert.ToDateTime(p.Handeddate);
                            DateTime currdate = DateTime.Now;
                            Double dffrdate = currdate.Subtract(dbdate).TotalDays;
                            if (dffrdate >= 365)
                            {
                                <h3><span class="label label-danger" style="background-color:red">Machine out of warranty</span></h3>
                            }
                            else
                            {
                                @Html.ActionLink("Generate MFR", "MFR", new { oanum = p.HODNumber }, new { @align = "center", @style = "width:50px;text-align:center", @class = "btn btn-info existingcustomer" })

                            }

                        }
                     </td>
                </tr>
                slno++;
            }

        </table>


    </div>
}


